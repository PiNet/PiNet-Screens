#!/usr/bin/env bash


LOGO=$(cat <<-END

  _____  _  _   _        _      _____
 |  __ \(_)| \ | |      | |    / ____|
 | |__) |_ |  \| |  ___ | |_  | (___    ___  _ __  ___   ___  _ __   ___
 |  ___/| || . ` | / _ \| __|  \___ \  / __|| '__|/ _ \ / _ \| '_ \ / __|
 | |    | || |\  ||  __/| |_   ____) || (__ | |  |  __/|  __/| | | |\__ \
 |_|    |_||_| \_| \___| \__| |_____/  \___||_|   \___| \___||_| |_||___/


[49m[K[0m[24C[48;5;231m       [49m
[22C[48;5;231m   [48;5;188m [48;5;16m   [48;5;231m    [49m
[22C[48;5;231m  [48;5;16m  [48;5;149m  [48;5;155m [48;5;16m [48;5;102m [48;5;231m  [49m
[19C[48;5;231m      [48;5;16m     [48;5;231m   [49m
[8C[48;5;231m       [2C   [48;5;16m      [48;5;231m          [49m
[6C[48;5;231m    [48;5;16m    [48;5;231m     [48;5;16m  [48;5;149m   [48;5;16m  [48;5;231m      [48;5;16m  [48;5;231m    [49m
[5C[48;5;231m   [48;5;16m  [48;5;149m   [48;5;58m [48;5;16m       [48;5;149m   [48;5;16m        [48;5;149m  [48;5;16m  [48;5;231m   [49m
[5C[48;5;231m   [48;5;16m [48;5;58m [48;5;149m    [48;5;16m  [48;5;231m     [48;5;16m   [48;5;231m     [48;5;16m  [48;5;149m   [48;5;16m  [48;5;231m   [49m
[5C[48;5;231m   [48;5;16m       [48;5;231m   [48;5;16m      [48;5;188m [48;5;231m     [48;5;188m [48;5;16m    [48;5;231m       [49m
[4C[48;5;231m           [48;5;16m   [48;5;168m      [48;5;53m [48;5;16m   [48;5;231m      [48;5;16m      [48;5;59m [48;5;231m   [49m
[2C[48;5;231m    [48;5;102m [48;5;145m [48;5;231m     [48;5;16m   [48;5;168m           [48;5;16m  [48;5;231m    [48;5;16m  [48;5;168m     [48;5;16m  [48;5;231m   [49m
[48;5;231m   [48;5;16m   [48;5;168m [48;5;204m [48;5;16m   [48;5;231m  [48;5;16m [48;5;89m [48;5;168m             [48;5;16m  [48;5;102m [48;5;16m   [48;5;168m      [48;5;204m [48;5;16m [48;5;188m [48;5;231m  [49m
[48;5;231m   [48;5;16m [48;5;132m [48;5;168m    [48;5;52m [48;5;16m    [48;5;168m              [48;5;16m  [48;5;231m   [48;5;16m  [48;5;168m     [48;5;16m  [48;5;231m   [49m
[48;5;231m   [48;5;16m  [48;5;204m [48;5;168m  [48;5;16m   [48;5;231m  [48;5;16m [48;5;168m              [48;5;16m  [48;5;231m    [48;5;145m [48;5;16m     [48;5;231m    [49m
[1C[48;5;231m    [48;5;16m   [48;5;145m [48;5;231m    [48;5;16m  [48;5;204m [48;5;168m           [48;5;16m  [48;5;231m  [48;5;16m     [48;5;231m      [49m
[3C[48;5;231m     [48;5;16m     [48;5;231m [48;5;16m   [48;5;131m [48;5;168m       [48;5;16m   [48;5;59m [48;5;16m  [48;5;168m    [48;5;204m [48;5;16m  [48;5;231m   [49m
[3C[48;5;231m   [48;5;16m  [48;5;168m    [48;5;204m [48;5;16m  [48;5;231m  [48;5;16m        [48;5;231m   [48;5;16m  [48;5;168m       [48;5;16m [48;5;145m [48;5;231m  [49m
[3C[48;5;231m  [48;5;16m  [48;5;168m       [48;5;16m  [48;5;231m      [48;5;16m  [48;5;145m [48;5;231m    [48;5;16m  [48;5;168m     [48;5;16m  [48;5;231m   [49m
[3C[48;5;231m  [48;5;16m  [48;5;168m       [48;5;16m  [48;5;231m   [48;5;16m   [48;5;204m [48;5;168m [48;5;204m [48;5;16m   [48;5;231m  [48;5;16m       [48;5;231m   [49m
[3C[48;5;231m   [48;5;16m   [48;5;168m   [48;5;89m [48;5;16m  [48;5;231m  [48;5;16m  [48;5;53m [48;5;168m       [48;5;52m [48;5;16m [48;5;231m          [49m
[4C[48;5;231m    [48;5;188m [48;5;16m   [48;5;145m [48;5;231m    [48;5;16m  [48;5;168m         [48;5;16m  [48;5;231m  [49m
[7C[48;5;231m       [1C  [48;5;16m  [48;5;168m        [48;5;204m [48;5;16m  [48;5;231m  [49m
[15C[48;5;231m   [48;5;16m   [48;5;168m     [48;5;16m   [48;5;231m   [49m
[16C[48;5;231m     [48;5;16m     [48;5;231m    [49m
[19C[48;5;231m         [0m

END
)



#echo "$LOGO"

echo ""
echo ""
echo "#################################################################################################################"
echo "This script will install the PiNet screens application."
echo "Note that the defaults used by the application assume the only PiNet Pis being used are used for display screens."

read -r -p "Are you sure? [y/N] " response
case "$response" in
    [yY][eE][sS]|[yY])
        echo "Installing..."
        ;;
    *)
        exit 1
        ;;
esac


mkdir /opt/PiNet-Screens
cp * /opt/PiNet-Screens

python3 -m venv /opt/PiNetScreens/venv
source /opt/PiNetScreens/venv/bin
pip3 -r install /opt/PiNetScreens/requirements.txt
deactivate

cp scripts/pinetscreens.service /etc/systemd/system/pinetscreens.service
python3 /opt/PiNetScreens/scripts/create_user.py

sudo systemctl start pinetscreens
sudo systemctl enable pinetscreens

sensible-browser localhost:80